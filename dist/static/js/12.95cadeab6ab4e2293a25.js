webpackJsonp([12],{HSEH:function(t,a){},SnjD:function(t,a,s){"use strict";(function(t){var o=s("Fhvg"),e=s("GJzV"),i=s("VXza"),r=s("NY0P"),n=s("BUS2");s.n(n);a.a={props:["id"],data:function(){return{alertInfo:"",toastInfo:"",isWarn:!1,isFail:!1,currentAccount:"",link:window.location.href,copyBtn:null,programs:{eosID:"",amount:0,supportTotal:"loading...",backers:"loading...",title:"loading...",photos:"",releaseTime:"loading...",endDate:"loading...",endTime:"",des:"loading...",creator:"loading...",targetAccount:"",targetToken:"",targetTokenContract:"",targetTokenDecimal:"",high:0,low:0},isNull:!1,support:[],link_isShow:!1,isActive:!0,totalEosPriceUsd:0,amount:"",note:""}},mounted:function(){var a=this;this.copyBtn=new this.clipboard(this.$refs.copy),this.getProjectInfo(),this.togglePayment(),this.tabFix(),t(window).scroll(function(){a.togglePayment(),a.tabFix()})},methods:{infoByToast:function(t){this.toastInfo=t},togglePayment:function(){t(".supportBtn")[0]&&(t(window).scrollTop()>t(".supportBtn").offset().top?t(".tab").addClass("scroll"):t(".tab").removeClass("scroll"))},tabFix:function(){if(t(".tab")[0]){var a=t(window).scrollTop()-(t(".detail-info").offset().top-t(".mds-nav").outerHeight());a>0?(t(".header-nav").css("top",-a+"px"),a>=50?t(".detail-info").addClass("fixed"):t(".detail-info").removeClass("fixed")):(t(".header-nav").css("top","0px"),t(".detail-info").removeClass("fixed"))}},toggleDetails:function(){this.isActive=!0},toggleTransfer:function(){this.isActive=!1},linkShow:function(){this.link_isShow=!this.link_isShow},copyLink:function(){var t=this;if(this.isWarn=!1,this.globalData.browsers.android){var a=document.createElement("input");a.type="text",a.value=this.link,document.body.appendChild(a),a.select(),document.execCommand("Copy"),a.parentNode.removeChild(a),this.isFail=!1,this.toastInfo=this.$t("copy_success")}else{var s=this.copyBtn;s.on("success",function(){t.isFail=!1,t.toastInfo=t.$t("copy_success"),s.destroy(),t.copyBtn=new t.clipboard(t.$refs.copy)}),s.on("error",function(){t.isFail=!0,t.toastInfo=t.$t("copy_error"),s.destroy(),t.copyBtn=new t.clipboard(t.$refs.copy)})}setTimeout(function(){t.link_isShow=!1},2e3)},payModal:function(){var a=this;if(this.programs.endDate<=0)return this.isWarn=!0,this.isFail=!1,this.toastInfo=this.$t("project_outDate"),!1;r.a.getAccount().then(function(s){t(".login").hide(),t(".personal").show(),t(".currentAccount").html(s.name),a.currentAccount=s.name,a.programs.creator==a.currentAccount?(a.isWarn=!0,a.isFail=!1,a.toastInfo=a.$t("not_support")):1==a.programs.type?a.$router.push({name:"projectPurchase",query:{id:a.id}}):t("#payment").modal("show")},function(){a.isWarn=!0,a.isFail=!1,a.toastInfo=a.$t("connect_scatter")})},payFunc:function(){var a=this,s=this,o=this.amount,e=this.note;return o-0<s.programs.low?(this.alertInfo="金额不能小于 "+s.programs.low+" "+s.programs.targetToken,t("#alert").modal("show"),!1):o-0>s.programs.high?(this.alertInfo="金额不能大于 "+s.programs.high+" "+s.programs.targetToken,t("#alert").modal("show"),!1):void r.a.getAccount().then(function(a){s.currentAccount=a.name,t(".login").hide(),t(".personal").show(),t(".currentAccount").html(a.name),r.a.getEos().transaction({actions:[{account:s.programs.targetTokenContract,name:"transfer",authorization:[{actor:s.currentAccount,permission:a.authority}],data:{from:s.currentAccount,to:s.programs.targetAccount,quantity:parseFloat(o).toFixed(s.programs.targetTokenDecimal)+" "+s.programs.targetToken,memo:'###{"ID":'+s.programs.eosID+',"creator":"'+s.programs.creator+'","comment":"'+e+'"}###'}}]}).then(function(a){var i=s.globalData.domain+"/apiCrowdfunding/trans",r={crowdfundingNo:s.programs.crowdfundingNo,hash:a.transaction_id,amount:o,from:s.currentAccount,to:s.programs.targetAccount,comment:e};t.post(i,r,function(a){a.success?(t("#payment").modal("hide"),s.alertInfo=s.$t("success"),t("#alert").modal("show"),t("#alert").on("hidden.bs.modal",function(t){window.location.reload()})):(s.alertInfo=a.message,t("#alert").modal("show"))},"json")}).catch(function(a){console.log(a),s.alertInfo=s.$t("pay_error"),t("#alert").modal("show")})},function(){a.isWarn=!0,a.isFail=!1,a.toastInfo=a.$t("connect_scatter")})},getProjectInfo:function(){var a=this.id,s=this,o=s.globalData.domain+"/apiCrowdfunding/getInfo?eosID="+a;t.get(o,{},function(a){a.success?(s.programs=a.data,s.programs.amount=parseFloat(a.data.amount).toFixed(s.programs.targetTokenDecimal),t.get(s.globalData.domain+"/apiCrowdfunding/getTransRecord",{crowdfundingNo:s.programs.crowdfundingNo},function(a){s.programs.supportTotal=parseFloat(a.data.total).toFixed(s.programs.targetTokenDecimal),s.programs.backers=a.data.count,a.success&&(t(".details img").css({width:"100%",margin:"10px 0"}),t.each(a.data.trans,function(t,o){s.support.push({id:t+1,address:o.from,amount:parseFloat(o.amount).toFixed(s.programs.targetTokenDecimal)+" "+a.data.token,comments:o.comment,time:o.createDate})}))},"json")):s.isNull=!0},"json")},getEosPrice:function(){var a=this;t.get("https://api.coinmarketcap.com/v1/ticker/eos/?convert=USD",{},function(t){a.totalEosPriceUsd=parseFloat(t[0].price_usd*a.amount).toFixed(2)},"json")}},components:{foot:i.a,alertModal:o.a,mdsToast:e.a}}}).call(a,s("7t+N"))},dhpt:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=s("SnjD"),e={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"project-detail"},[t.isNull?s("div",{staticClass:"isNull"},[t._v(t._s(t.$t("project_error")))]):[s("div",{staticClass:"container"},[s("div",{staticClass:"title"},[t._v(t._s(t.programs.title))]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("p",{staticClass:"pic",style:{background:"rgba(0,0,0,0.05) url("+t.programs.photos+")no-repeat center/cover"}}),t._v(" "),s("div",{staticClass:"author-info clearfix"},[s("div",{staticClass:"copy-link"},[s("p",{ref:"copy",attrs:{"data-clipboard-target":"#copyContent","data-clipboard-action":"copy"},on:{click:t.copyLink}},[s("img",{attrs:{src:"static/img/icon/web_icon_link.png",height:"48"}})]),t._v(" "),s("div",{ref:"copyContent",attrs:{id:"copyContent"}},[t._v(t._s(t.link))])]),t._v(" "),s("p",{staticClass:"avator"},[s("img",{attrs:{src:"https://api.medishares.net/apiTools/getAddressHead?address="+t.programs.creator+"&v=1.0",width:"20"}})]),t._v(" "),s("p",{staticClass:"address"},[t._v(t._s(t.programs.creator))]),t._v(" "),s("p",[t._v(t._s(t.$t("release_time"))+": "+t._s(t.programs.releaseTime.replace(/\//g,"-")))])])]),t._v(" "),s("div",{staticClass:"col-sm-4"},[s("div",{staticClass:"progress"},[s("p",{staticClass:"progress-bar",style:"width:"+parseFloat(t.programs.supportTotal/t.programs.amount*100)+"%"})]),t._v(" "),s("h4",{staticClass:"pro-value main-color"},[t._v(t._s(t.programs.supportTotal)+" "+t._s(t.programs.targetToken))]),t._v(" "),s("p",{staticClass:"pro-key"},[t._v(t._s(t.$t("pledged"))+" "+t._s(t.programs.amount)+" "+t._s(t.programs.targetToken))]),t._v(" "),s("h4",{staticClass:"pro-value"},[t._v(t._s(t.programs.backers?t.programs.backers:0))]),t._v(" "),s("p",{staticClass:"pro-key"},[t._v(t._s(t.$t("backers")))]),t._v(" "),s("h4",{staticClass:"pro-value"},[t._v(t._s(t.programs.endDate>0?t.programs.endDate:0))]),t._v(" "),s("p",{staticClass:"pro-key"},[t._v(t._s(t.$t("for_the_rest")))]),t._v(" "),s("div",{class:[{unPay:t.programs.endDate<=0},"confirm supportBtn"],on:{click:t.payModal}},[1==t.programs.type?[t._v(t._s(t.$t("payment")))]:[t._v(t._s(t.$t("donate")))]],2)])])]),t._v(" "),s("section",{staticClass:"detail-info"},[s("div",{staticClass:"tab"},[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("a",{class:{active:t.isActive},on:{click:t.toggleDetails}},[t._v(t._s(t.$t("details")))]),t._v(" "),s("a",{class:{active:!t.isActive},on:{click:t.toggleTransfer}},[t._v(t._s(t.$t("transfer")))])]),t._v(" "),s("div",{staticClass:"col-sm-4 hidden-xs"},[s("div",{class:[{unPay:t.programs.endDate<=0},"confirm"],on:{click:t.payModal}},[1==t.programs.type?[t._v(t._s(t.$t("payment")))]:[t._v(t._s(t.$t("donate")))]],2)])])])]),t._v(" "),s("div",{staticClass:"container detail-info-container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"details",domProps:{innerHTML:t._s(t.programs.des)}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isActive,expression:"!isActive"}],staticClass:"transfer"},[s("div",{staticClass:"info-title"},[t._v(t._s(t.support.length)+" "+t._s(t.$t("support")))]),t._v(" "),t._l(t.support,function(a){return s("div",{key:a.id,staticClass:"transfer-list"},[s("img",{staticClass:"trans-avator",attrs:{src:"static/img/icon/web_icon_ID.png",width:"48"}}),t._v(" "),s("div",{staticClass:"trans-info"},[s("p",{staticClass:"trans-amount"},[t._v(t._s(a.amount))]),t._v(" "),s("p",{staticClass:"address"},[t._v(t._s(a.address))]),t._v(" "),a.comments?s("p",{staticClass:"trans-comments"},[t._v(t._s(a.comments))]):t._e(),t._v(" "),s("p",{staticClass:"trans-time"},[t._v(t._s(a.time))])])])})],2)])])])])],t._v(" "),s("foot"),t._v(" "),s("div",{staticClass:"modal",attrs:{id:"payment"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),s("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("donate")))]),t._v(" "),s("label",[t._v(t._s(t.$t("pay_amount")))]),t._v(" "),s("p",{staticClass:"basic-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],staticClass:"basic-input",attrs:{type:"number",placeholder:t.$t("pay_amount_pl")},domProps:{value:t.amount},on:{blur:t.getEosPrice,input:function(a){a.target.composing||(t.amount=a.target.value)}}}),t._v(" "),s("span",{staticClass:"target-token"},[t._v(t._s(t.programs.targetToken))]),t._v(" "),s("span",{staticClass:"equal"},[t._v("≈$"+t._s(t.totalEosPriceUsd))])]),t._v(" "),s("label",[t._v(t._s(t.$t("note")))]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"basic-input",attrs:{rows:"4",placeholder:t.$t("note_pl")},domProps:{value:t.note},on:{input:function(a){a.target.composing||(t.note=a.target.value)}}}),t._v(" "),s("div",{staticClass:"confirm",on:{click:t.payFunc}},[t._v(t._s(t.$t("determine")))])])])]),t._v(" "),s("alert-modal",{attrs:{info:t.alertInfo}}),t._v(" "),s("mds-toast",{attrs:{toastInfo:t.toastInfo,isWarn:t.isWarn,isFail:t.isFail},on:{toast:t.infoByToast}})],2)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}]};var i=function(t){s("HSEH")},r=s("VU/8")(o.a,e,!1,i,"data-v-a37f138a",null);a.default=r.exports}});
//# sourceMappingURL=12.95cadeab6ab4e2293a25.js.map
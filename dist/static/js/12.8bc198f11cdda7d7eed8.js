webpackJsonp([12],{eWQ9:function(t,e,s){"use strict";(function(t){var n=s("GJzV"),r=s("VXza"),a=s("NY0P"),o=s("BUS2"),i=s.n(o);e.a={props:["id"],data:function(){return{getInfoUrl:"/apiCrowdfunding/getInfo?eosID=",orderUrl:"/apiOrder/create",currentAccount:"",isEdit:!1,gearList:[],selectedOrder:null,toastInfo:"",isWarn:!0,programs:"",note:"",noteHash:"",isNull:!1}},mounted:function(){var t=this;this.getUser(),this.gearList.map(function(e){t.$set(e,"isSelected",!1)}),this.getProjectInfo()},methods:{infoByToast:function(t){this.toastInfo=t},getUser:function(){var e=this;a.a.getAccount().then(function(s){t(".login").hide(),t(".personal").show(),t(".currentAccount").html(s.name),e.currentAccount=s.name},function(){e.toastInfo=e.$t("connect_scatter")})},getProjectInfo:function(){var t=this;if(this.$route.params.order){var e=this.$route.params.order.level-1;this.selectedOrder=this.$route.params.order,this.programs=this.selectedOrder.programs,this.gearList=JSON.parse(this.programs.json),this.gearList.map(function(e){t.$set(e,"isSelected",!1),t.$set(e,"num",0),t.$set(e,"max_number",parseInt(t.programs.amount/e.money*Math.pow(10,e.targetTokenDecimal)))}),this.gearList[e]=this.selectedOrder,this.note=this.selectedOrder.note}else this.$http.get(this.globalData.domain+this.getInfoUrl+this.id).then(function(e){e.data.success&&1==e.data.data.type?(t.programs=e.data.data,t.gearList=JSON.parse(t.programs.json),t.gearList.map(function(e){t.$set(e,"isSelected",!1),t.$set(e,"num",0),t.$set(e,"max_number",parseInt(t.programs.amount/e.money*Math.pow(10,e.targetTokenDecimal)))})):t.isNull=!0},function(t){console.log(t)})},selectGear:function(t){var e=this;this.gearList.map(function(t){e.$set(t,"isSelected",!1)}),t.isSelected=!0,this.selectedOrder=t},subNumber:function(t){t.num--,t.num<0?(this.toastInfo=this.$t("subNumber_limit"),t.num=0):t.num>0?this.selectGear(t):0==t.num&&(t.isSelected=!1,this.selectedOrder=null)},addNumber:function(t){t.num++,t.num>t.max_number&&(this.toastInfo=this.$t("addNumber_limit"),t.num=t.max_number),this.selectGear(t)},changeNumber:function(t){t.num>t.max_number&&(this.toastInfo=this.$t("buyNumber_limit"),t.num=t.max_number),t.num>0&&this.selectGear(t),0==t.num&&(t.isSelected=!1,this.selectedOrder=null)},submitOrder:function(){var e=this;a.a.getAccount().then(function(s){return t(".login").hide(),t(".personal").show(),t(".currentAccount").html(s.name),e.currentAccount=s.name,e.programs.creator==e.currentAccount?(e.toastInfo=e.$t("not_support"),!1):e.selectedOrder?e.selectedOrder.num<1?(e.toastInfo=e.$t("purchase_no_number"),!1):(e.selectedOrder.programs=e.programs,e.selectedOrder.noteHash=i.a.sha256(e.note),e.selectedOrder.note=e.note,e.selectedOrder.amount=e.selectedOrder.money/Math.pow(10,e.selectedOrder.targetTokenDecimal)*e.selectedOrder.num,void e.$http.post(e.globalData.domain+e.orderUrl,{account:e.currentAccount,crowdfundingID:e.programs.crowdfundingID,level:e.selectedOrder.level,num:e.selectedOrder.num,note:e.note,noteHash:i.a.sha256(e.note)},{emulateJSON:!0}).then(function(t){t.data.success&&(e.selectedOrder.orderNo=t.data.data.orderNo,e.$router.push({name:"orderDetail",params:{order:e.selectedOrder,id:e.id}}))},function(t){console.log(t)})):(e.toastInfo=e.$t("purchase_no_chosen"),!1)},function(){e.toastInfo=e.$t("connect_scatter")})}},components:{foot:r.a,mdsToast:n.a}}}).call(e,s("7t+N"))},pAsm:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("eWQ9"),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-purchase"},[t.isNull?s("div",{staticClass:"isNull"},[t._v(t._s(t.$t("project_error")))]):[s("div",{staticClass:"container top-container hidden-xs"},[s("h4",{staticClass:"select-title"},[t._v(t._s(t.$t("project_name"))+":")]),t._v(" "),s("div",{staticClass:"title"},[t._v(t._s(t.programs.title))])]),t._v(" "),s("section",{staticClass:"select-gear"},[s("div",{staticClass:"container"},[s("h4",{staticClass:"select-title"},[t._v(t._s(t.$t("choose_gear")))]),t._v(" "),s("div",{staticClass:"row"},[s("ul",{staticClass:"col-sm-8 select-list"},[t._l(t.gearList,function(e,n){return s("li",{key:n,class:[{selected:e.isSelected},"clearfix"]},[s("div",{staticClass:"list-info clearfix",on:{click:function(s){t.selectGear(e)}}},[s("p",{staticClass:"pic",style:{background:"url("+t.programs.photos+")no-repeat center/cover"}}),t._v(" "),s("h3",[t._v(t._s(e.money/Math.pow(10,e.targetTokenDecimal))+" "+t._s(e.targetToken))]),t._v(" "),s("div",{staticClass:"gear-type"},[t._v(t._s(t.$t("gear"+e.level))+" : "+t._s(e.unitNum)+" "+t._s(t.$t("unit_"+e.unit)))])]),t._v(" "),s("div",{staticClass:"add_sub"},[s("img",{attrs:{src:"static/img/icon/sub.jpg",width:"34"},on:{click:function(s){t.subNumber(e)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.num,expression:"item.num"}],staticClass:"add_number",attrs:{type:"tel"},domProps:{value:e.num},on:{input:[function(s){s.target.composing||t.$set(e,"num",s.target.value)},function(s){t.changeNumber(e)}]}}),s("img",{attrs:{src:"static/img/icon/add.jpg",width:"34"},on:{click:function(s){t.addNumber(e)}}})])])}),t._v(" "),s("div",{staticClass:"comment"},[s("h4",{staticClass:"select-title"},[t._v(t._s(t.$t("comments")))]),t._v(" "),s("div",{staticClass:"comment-info"},[s("div",{staticClass:"user-info hidden-xs"},[s("img",{attrs:{src:"static/img/icon/web_icon_ID.png"}}),t._v(" "),s("p",[t._v(t._s(t.currentAccount))])]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],attrs:{placeholder:t.$t("note_pl")},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})])]),t._v(" "),s("div",{class:[{active:t.selectedOrder&&t.selectedOrder.num>0},"confirm"],on:{click:t.submitOrder}},[t._v(t._s(t.$t("confirm")))])],2),t._v(" "),s("div",{staticClass:"col-sm-4 mds_notice"},[s("h4",{staticClass:"hidden-xs"},[t._v(t._s(t.$t("mds_notice1")))]),t._v(" "),s("p",{staticClass:"hidden-xs"},[t._v(t._s(t.$t("mds_notice2")))]),t._v(" "),s("p",{staticClass:"notice-xs hidden-sm hidden-md hidden-lg"},[t._v(t._s(t.$t("mds_notice1"))+t._s(t.$t("mds_notice2")))])])])])])],t._v(" "),s("foot"),t._v(" "),s("mds-toast",{attrs:{toastInfo:t.toastInfo,isWarn:t.isWarn},on:{toast:t.infoByToast}})],2)},staticRenderFns:[]};var a=function(t){s("zrkV")},o=s("VU/8")(n.a,r,!1,a,"data-v-95debd7a",null);e.default=o.exports},zrkV:function(t,e){}});
//# sourceMappingURL=12.8bc198f11cdda7d7eed8.js.map